<% if (theme.instantclick){ %>
	<script src="<%- theme.js.instantclick %>" data-no-instant></script>
	<script data-no-instant>
		<% if (theme.google_analytics){ %>
			(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
			})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
			ga('create', '<%- theme.google_analytics %>', 'auto');
			ga('send', 'pageview');
  			InstantClick.on('change', function() {
  				ga('send', 'pageview', location.pathname + location.search);
			});
		<% } %>
		InstantClick.init('mousedown');
	</script>
<% } %>
<% if (theme.service_worker){ %>
	<script>
		if ('serviceWorker' in navigator) {
			navigator.serviceWorker.register('<%- theme.js.service_worker %>');
		}
	</script>
<% } %>

<% if (!is_post()&&!is_page()){ %>
	<script>
		// To make images retina, add a class "2x" to the img element
		var isMobile = {
			Android:function() {
				return navigator.userAgent.match(/Android/i) ? true : false;
			},
			BlackBerry:function(){
				return navigator.userAgent.match(/BlackBerry/i) ? true : false;
			},
			iOS:function(){
				return navigator.userAgent.match(/iPhone|iPad|iPod/i) ? true : false;
			},
			Windows:function(){
				return navigator.userAgent.match(/IEMobile/i) ? true : false;
			},
			any:function(){
			   return (isMobile.Android() || isMobile.BlackBerry() || isMobile.iOS() || isMobile.Windows());
			}
		};
		if (isMobile.any()) {
			var suffix = document.getElementsByClassName('2x')[0].getAttribute('src');
			suffix = suffix.replace('.png','@2x.png');
			suffix = suffix.replace('.jpg','@2x.jpg');
			document.getElementsByClassName('2x')[0].setAttribute('src',suffix);
		};
	</script>
	<% if (theme.hitokoto){ %>
		<script src="<%- theme.js.hitokoto %>" defer></script>
	<% } %>
<% } %>